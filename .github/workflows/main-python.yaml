name: Main

on:
  workflow_call:
    inputs:
      cluster:
        description: 'The development cluster to target.'
        default: 'dev-1'
        required: false
        type: string
    secrets:
      gh-token:
        description: 'PAT used for pushing GHCR images.'
        required: true

jobs:

  # Builds and pushes images to GHCR.
  deploy:
    name: Deploy
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v3

    - name: Build and Push
      uses: gramLabs/.github/.github/actions/build-push@main
      with:
        cluster: '${{ inputs.cluster }}'
        gh-token: '${{ secrets.gh-token }}'
